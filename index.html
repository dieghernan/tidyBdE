<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Download Data from Bank of Spain • tidyBdE</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- Google Fonts --><link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Roboto+Mono&amp;family=Roboto:wght@100;300;400;500;700&amp;display=swap" rel="stylesheet">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><!-- Hugo Universal --><link href="style.violet.css" rel="stylesheet">
<!-- rOpenSpain --><link href="ropenspain.css" rel="stylesheet">
<meta property="og:title" content="Download Data from Bank of Spain">
<meta property="og:description" content="Tools to download data series from Banco de España (BdE) on 
    tibble format. Banco de España is the national central bank 
    and, within the framework of the Single Supervisory Mechanism (SSM), the 
    supervisor of the Spanish banking system along with the European Central 
    Bank. This package is in no way sponsored endorsed or administered by 
    Banco de España.">
<meta property="og:image" content="https://ropenspain.github.io/tidyBdE/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-CW2RTVRRVF"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-CW2RTVRRVF');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed btn-template-main" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <i class="fa fa-align-justify"></i>
      </button>
      <span class="navbar-brand" id="ROS-navbar-brand">
      <a class="navbar-link ROS-black" href="index.html"><img src="logo.png" alt="tidyBdE-logo" id="ROS-navbar-logo">tidyBdE</a> <span class="version label label-default hidden-xs" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.9000</span>
      </span>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="articles/tidyBdE.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
        <li>
  <a href="https://github.com/rOpenSpain/tidyBdE/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>  <!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->


      

      </header><div class="row">
  <div class="contents col-md-9" id="home">
<div id="tidybde-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#tidybde-" class="anchor"></a>tidyBdE <img src="reference/figures/logo.png" align="right" width="120">
</h1></div>
<!-- badges: start -->

<!-- badges: end -->
<p><strong>tidyBdE</strong> is an API package that helps to retrieve data from <a href="https://www.bde.es/webbde/en/estadis/infoest/descarga_series_temporales.html">Banco de España</a>. The data is provided as <a href="https://tibble.tidyverse.org/">tibble</a> and the package tries to guess the format of every time-series (dates, characters and numbers).</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Install <strong>tidyBdE</strong> from <a href="https://CRAN.R-project.org/package=tidyBdE"><strong>CRAN</strong></a>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"tidyBdE"</span><span class="op">)</span></code></pre></div>
<p>You can install the developing version of <strong>tidyBdE</strong> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://remotes.r-lib.org">remotes</a></span><span class="op">)</span>

<span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"ropenspain/tidyBdE"</span><span class="op">)</span></code></pre></div>
</div>
<div id="examples" class="section level2">
<h2 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h2>
<p>Banco de España (<strong>BdE</strong>) provides several time-series, either produced by the institution itself or compiled for another sources, as <a href="https://ec.europa.eu/eurostat">Eurostat</a> or <a href="https://www.ine.es/">INE</a>.</p>
<p>The basic entry point for searching time-series are the catalogs (<em>indexes</em>) of information. You can search any series by name:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ropenspain.github.io/tidyBdE/">tidyBdE</a></span><span class="op">)</span>

<span class="co"># Search GBP on "TC" (exchange rate) catalog</span>
<span class="va">XR_GBP</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/bde_catalog_search.html">bde_catalog_search</a></span><span class="op">(</span><span class="st">"GBP"</span>, catalog <span class="op">=</span> <span class="st">"TC"</span><span class="op">)</span>

<span class="va">XR_GBP</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt; # A tibble: 1 x 2</span>
<span class="co">#&gt;   Numero_secuencial Descripcion_de_la_serie                                     </span>
<span class="co">#&gt;               &lt;dbl&gt; &lt;chr&gt;                                                       </span>
<span class="co">#&gt; 1            573214 Tipo de cambio. Libras esterlinas por euro (GBP/EUR).Datos …</span></code></pre></div>
<p><strong>Note that BdE files are only provided in Spanish, for the time being</strong>, the organism is working on the English version. By now, search terms should be provided in Spanish in order to get search results.</p>
<p>After we have found our series, we can load the series for the GBP/EUR exchange rate using the sequential number reference (<code>Numero_Secuencial</code>) as:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load tidyverse for better handling</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="co">#&gt; ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──</span>
<span class="co">#&gt; ✓ ggplot2 3.3.3     ✓ purrr   0.3.4</span>
<span class="co">#&gt; ✓ tibble  3.1.0     ✓ dplyr   1.0.5</span>
<span class="co">#&gt; ✓ tidyr   1.1.3     ✓ stringr 1.4.0</span>
<span class="co">#&gt; ✓ readr   1.4.0     ✓ forcats 0.5.1</span>
<span class="co">#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──</span>
<span class="co">#&gt; x dplyr::filter() masks stats::filter()</span>
<span class="co">#&gt; x dplyr::lag()    masks stats::lag()</span>

<span class="va">time_series</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/bde_series_load.html">bde_series_load</a></span><span class="op">(</span><span class="fl">573214</span>, series_label <span class="op">=</span> <span class="st">"EUR_GBP_XR"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Date</span> <span class="op">&gt;=</span> <span class="st">"2010-01-01"</span> <span class="op">&amp;</span> <span class="va">Date</span> <span class="op">&lt;=</span> <span class="st">"2020-12-31"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">drop_na</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>The package also provides a custom <code>ggplot2</code> theme based on the publications of BdE:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">time_series</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Date</span>, y <span class="op">=</span> <span class="va">EUR_GBP_XR</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>colour <span class="op">=</span> <span class="fu"><a href="reference/bde_vivid_pal.html">bde_vivid_pal</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"gam"</span>, colour <span class="op">=</span> <span class="fu"><a href="reference/bde_vivid_pal.html">bde_vivid_pal</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    title <span class="op">=</span> <span class="st">"EUR/GBP Exchange Rate (2010-2020)"</span>,
    subtitle <span class="op">=</span> <span class="st">"%"</span>,
    caption <span class="op">=</span> <span class="st">"Source: BdE"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_vline</span><span class="op">(</span>
    xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2016-06-23"</span><span class="op">)</span>,
    linetype <span class="op">=</span> <span class="st">"dotted"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_label</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2016-06-23"</span><span class="op">)</span>,
    y <span class="op">=</span> <span class="fl">.95</span>,
    label <span class="op">=</span> <span class="st">"Brexit"</span>
  <span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="reference/theme_bde.html">theme_bde</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; `geom_smooth()` using formula 'y ~ s(x, bs = "cs")'</span></code></pre></div>
<p><img src="reference/figures/README-chart-1.png" width="100%"></p>
<p>The package provides also several “shortcut” functions for a selection of the most relevant macroeconomic series, so there is no need to look for them in advance:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gdp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/bde_ind_gdp_var.html">bde_ind_gdp_var</a></span><span class="op">(</span><span class="st">"values"</span><span class="op">)</span>
<span class="va">gdp</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="st">"GDP YoY"</span>

<span class="va">UnempRate</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/bde_ind_gdp_var.html">bde_ind_unemployment_rate</a></span><span class="op">(</span><span class="st">"values"</span><span class="op">)</span>
<span class="va">UnempRate</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="st">"Unemployment Rate"</span>

<span class="va">plotseries</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">gdp</span>, <span class="va">UnempRate</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">drop_na</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Date</span> <span class="op">&gt;=</span> <span class="st">"2010-01-01"</span> <span class="op">&amp;</span> <span class="va">Date</span> <span class="op">&lt;=</span> <span class="st">"2019-12-31"</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span><span class="va">plotseries</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Date</span>, y <span class="op">=</span> <span class="va">values</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">label</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    title <span class="op">=</span> <span class="st">"Spanish Economic Indicators (2010-2019)"</span>,
    subtitle <span class="op">=</span> <span class="st">"%"</span>,
    caption <span class="op">=</span> <span class="st">"Source: BdE"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="reference/theme_bde.html">theme_bde</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="reference/bde_vivid_pal.html">bde_scale_color_vivid</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># Custom palette on the package</span></code></pre></div>
<p><img src="reference/figures/README-macroseries-1.png" width="100%"></p>
<p>Two custom palettes, based on the used by BdE on some publications are available.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">opar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/show_col.html">show_col</a></span><span class="op">(</span><span class="fu"><a href="reference/bde_vivid_pal.html">bde_rose_pal</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span><span class="st">"bde_rose_pal()"</span><span class="op">)</span>
<span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/show_col.html">show_col</a></span><span class="op">(</span><span class="fu"><a href="reference/bde_vivid_pal.html">bde_vivid_pal</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span><span class="st">"bde_vivid_pal()"</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-palettes-1.png" width="100%"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">opar</span><span class="op">)</span></code></pre></div>
<p>Those palettes can be applied to a <code>ggplot2</code> using some custom utils included on the package (see <code><a href="reference/bde_vivid_pal.html">help("bde_vivid_pal", package = "tidyBdE")</a></code>).</p>
<p>Here you can find an example using <code><a href="reference/bde_vivid_pal.html">bde_scale_fill_rose()</a></code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load GDP Series</span>

<span class="va">GDP</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/bde_series_load.html">bde_series_load</a></span><span class="op">(</span>
  series_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="fl">3777251</span>,
    <span class="fl">3777265</span>,
    <span class="fl">3777259</span>,
    <span class="fl">3777269</span>,
    <span class="fl">3777060</span>
  <span class="op">)</span>,
  series_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="st">"Agriculture"</span>,
    <span class="st">"Industry"</span>,
    <span class="st">"Construction"</span>,
    <span class="st">"Services"</span>,
    <span class="st">"Total"</span>
  <span class="op">)</span>
<span class="op">)</span>


<span class="co"># Manipulate data - tidyverse style</span>

<span class="va">GDP_all</span> <span class="op">&lt;-</span> <span class="va">GDP</span> <span class="op">%&gt;%</span>
  <span class="co"># Filter dates</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Date</span> <span class="op">&lt;=</span> <span class="st">"2020-12-31"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="co"># Create 'Other' column and convert Date to year</span>
  <span class="fu">mutate</span><span class="op">(</span>
    Other <span class="op">=</span> <span class="va">Total</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="va">Agriculture</span><span class="op">:</span><span class="va">Services</span><span class="op">)</span><span class="op">)</span>,
    Date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">Date</span>, format <span class="op">=</span> <span class="st">"%Y"</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="co"># Sum by year</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Date</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise_at</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="op">-</span><span class="fu">group_cols</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, <span class="va">sum</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="co"># Create percentage</span>
  <span class="fu">relocate</span><span class="op">(</span><span class="va">Total</span>, .after <span class="op">=</span> <span class="va">Other</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="va">Agriculture</span><span class="op">:</span><span class="va">Other</span>, <span class="op">~</span> <span class="va">.x</span> <span class="op">/</span> <span class="va">Total</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="co"># Move cols to rows for plotting</span>
  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">Total</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span><span class="va">Agriculture</span><span class="op">:</span><span class="va">Other</span>,
    names_to <span class="op">=</span> <span class="st">"serie"</span>,
    values_to <span class="op">=</span> <span class="st">"value"</span>
  <span class="op">)</span>



<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">GDP_all</span>, <span class="fu">aes</span><span class="op">(</span>
  x <span class="op">=</span> <span class="va">Date</span>,
  y <span class="op">=</span> <span class="va">value</span>,
  fill <span class="op">=</span> <span class="va">serie</span>
<span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_bar</span><span class="op">(</span>
    position <span class="op">=</span> <span class="st">"stack"</span>,
    stat <span class="op">=</span> <span class="st">"identity"</span>,
    alpha <span class="op">=</span> <span class="fl">0.8</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="reference/bde_vivid_pal.html">bde_scale_fill_rose</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Custom palette on the package</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="reference/theme_bde.html">theme_bde</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    title <span class="op">=</span> <span class="st">"Spain: Gross domestic product by industry"</span>,
    subtitle <span class="op">=</span> <span class="st">"%"</span>,
    caption <span class="op">=</span> <span class="st">"Source: BdE"</span>
  <span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-gdp-1.png" width="100%"></p>
<div id="a-note-on-caching" class="section level3">
<h3 class="hasAnchor">
<a href="#a-note-on-caching" class="anchor"></a>A note on caching</h3>
<p>You can use <strong>tidyBdE</strong> to create your own local repository at a given local directory passing the following option:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>bde_cache_dir <span class="op">=</span> <span class="st">"./path/to/location"</span><span class="op">)</span></code></pre></div>
<p>When this option is set, <strong>tidyBdE</strong> would look for the cached file on the <code>bde_cache_dir</code> directory and it will load it, speeding up the process.</p>
<p>It is possible to update the data (i.e. after every monthly or quarterly data release) with the following commands:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/bde_catalog_update.html">bde_catalog_update</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># On most of the functions using the option update_cache = TRUE</span>

<span class="fu"><a href="reference/bde_series_load.html">bde_series_load</a></span><span class="op">(</span><span class="st">"SOME ID"</span>, update_cache <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="another-r-packages-for-downloading-spanish-open-data" class="section level2">
<h2 class="hasAnchor">
<a href="#another-r-packages-for-downloading-spanish-open-data" class="anchor"></a>Another R packages for downloading Spanish open data</h2>
<p>Other useful packages that provides access to Spanish open data:</p>
<ul>
<li>
<a href="https://ropenspain.github.io/opendataes/"><strong>opendataes</strong></a>: A package that downloads data from the <a href="https://datos.gob.es" class="uri">https://datos.gob.es</a> API.</li>
<li>
<a href="https://github.com/rOpenSpain/MicroDatosEs"><strong>MicroDatosEs</strong></a>: A package that process microdata provided by Spanish statistical agencies (mostly, INE).</li>
<li>
<a href="https://github.com/rOpenSpain/CatastRo"><strong>CatastRo</strong></a>: A package that queries Sede electrónica del Catastro API.</li>
<li>
<a href="https://ropenspain.github.io/mapSpain/"><strong>mapSpain</strong></a>: For downloading geospatial information from Instituto Geográfico Nacional (IGN) and creating maps of Spain.</li>
</ul>
</div>
<div id="disclaimer" class="section level2">
<h2 class="hasAnchor">
<a href="#disclaimer" class="anchor"></a>Disclaimer</h2>
<p>This package is in no way sponsored endorsed or administered by Banco de España.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=tidyBdE">https://​cloud.r-project.org/​package=tidyBdE</a>
</li>
<li>Browse source code at <br><a href="https://github.com/rOpenSpain/tidyBdE/">https://​github.com/​rOpenSpain/​tidyBdE/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/rOpenSpain/tidyBdE/issues">https://​github.com/​rOpenSpain/​tidyBdE/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing tidyBdE</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Diego H. Herrero <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0001-8457-4658" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://ropenspain.es/"><img src="https://ropenspain.github.io/rostemplate/reference/figures/ropenspain-badge.svg" alt="rOS-badge"></a></li>
<li><a href="https://CRAN.R-project.org/package=tidyBdE"><img src="https://www.r-pkg.org/badges/version/tidyBdE" alt="CRAN-status"></a></li>
<li><a href="https://cran.r-project.org/web/checks/check_results_tidyBdE.html"><img src="https://cranchecks.info/badges/worst/tidyBdE" alt="CRAN-results"></a></li>
<li><a href="https://cran.r-project.org/web/checks/check_results_tidyBdE.html"><img src="https://www.r-pkg.org/badges/ago/tidyBdE" alt="On-CRAN"></a></li>
<li><a href="https://github.com/rOpenSpain/tidyBdE/actions/workflows/check-full.yaml"><img src="https://github.com/rOpenSpain/tidyBdE/actions/workflows/check-full.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://codecov.io/gh/ropenspain/tidyBdE"><img src="https://codecov.io/gh/ropenspain/tidyBdE/branch/main/graph/badge.svg" alt="codecov"></a></li>
<li><a href="https://doi.org/10.5281/zenodo.4673496"><img src="https://img.shields.io/badge/DOI-10.5281/zenodo.4673496-blue" alt="DOI"></a></li>
<li><a href="https://cran.r-project.org/package=tidyBdE"><img src="http://cranlogs.r-pkg.org/badges/grand-total/tidyBdE?color=blue" alt="Downloads"></a></li>
</ul>
</div>
</div>
</div>

<script>
  var home = document.getElementById("home");
  var banner = document.createElement('div');
  banner.innerHTML = '<a href="https://ropenspain.es/">' +
      '<div id="ROS-heading-breadcrumbs">' +
        '<div class="text-center" id="ROS-partof">' +
          '<p>Part of <img src="ROS-logo.png" alt="ROpenSpain Logo" height="24"> ROpenSpain </p>' +
        '</div></div></a>'

  home.insertBefore(banner,home.firstChild);
</script><footer id="footer"><div class="container">
		<div class="col-md-3 col-sm-6 col-md-offset-1">
			<h4 data-toc-skip>About tidyBdE</h4>
			Developed by Diego H. Herrero, part of the <span class="ROS-light">rOpenSpain</span> project.
			<hr class="hidden-md hidden-lg hidden-sm">
</div>
		<div class="col-md-3 col-sm-6 col-md-offset-4">
			<h4 data-toc-skip>About <img src="ROS-logo.png" alt="ROpenSpain Logo" height="24"><span class="ROS-light"> rOpenSpain</span>
</h4>
			<a href="https://ropenspain.es/"><span class="ROS-light">rOpenSpain</span></a> is a community of R enthusiasts whose ultimate goal is to create high-quality R packages for data mining public spanish open sources.
			<hr class="hidden-md hidden-lg hidden-sm">
</div>
	</div>
</footer><div id="copyright">
	<div class="container">
		<div class="col-md-12">
			<p class="pull-left">
			Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.
			</p>
			<p class="pull-right">
			Template by <a href="https://bootstrapious.com/snippets">Bootstrapious </a>.
			Ported to pkgdown by <a href="https://github.com/dieghernan/">dieghernan</a>.
			</p>
		</div>
	</div>
</div>

<!-- ropenspain -->
<script src="ropenspain.js"></script>
</div>
   
  


  </body>
</html>
